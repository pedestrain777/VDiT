# VBench è§†é¢‘ç”Ÿæˆè„šæœ¬ä½¿ç”¨è¯´æ˜

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°

- **ç›®æ ‡**: ä»10ä¸ªpromptæ–‡ä»¶ä¸­å„å–å‰3ä¸ªpromptsï¼Œæ¯ä¸ªpromptç”Ÿæˆ5ä¸ªè§†é¢‘
- **é…ç½®**: ä½¿ç”¨ (40,10) é…ç½®ï¼šå‰40æ­¥ CogVideoX-5Bï¼Œå10æ­¥ CogVideoX-2B
- **å‘½åæ ¼å¼**: VBenchæ ‡å‡†æ ¼å¼ `{prompt}-{index}.mp4`
- **ä¿å­˜ä½ç½®**: æ‰€æœ‰è§†é¢‘ä¿å­˜åœ¨å•æ–‡ä»¶å¤¹ä¸­

## ğŸ“Š ç”Ÿæˆç»Ÿè®¡

- **Promptæ–‡ä»¶æ•°**: 10ä¸ªï¼ˆæ’é™¤ temporal_flickering.txtï¼‰
- **æ¯ä¸ªæ–‡ä»¶é€‰æ‹©çš„prompts**: 3ä¸ª
- **æ€»promptsæ•°**: 30ä¸ª
- **æ¯ä¸ªpromptçš„è§†é¢‘æ•°**: 5ä¸ª
- **æ€»è§†é¢‘æ•°**: 150ä¸ª

## ğŸš€ ä½¿ç”¨æ­¥éª¤

### æ­¥éª¤ 1: åˆ›å»º metadata.csv

é¦–å…ˆéœ€è¦åˆ›å»ºmetadata.csvæ–‡ä»¶ï¼š

```bash
cd /home/jiayu/hengyi_zhang/Hybrid-SD-main_for_v2i
python3 tools/vbench/build_metadata.py --config configs/vbench_40_10_10files.yaml
```

è¿™ä¼šåˆ›å»º `results/vbench/compare_40_10_10files/metadata.csv` æ–‡ä»¶ã€‚

### æ­¥éª¤ 2: è¿è¡Œè§†é¢‘ç”Ÿæˆ

ä½¿ç”¨VBenchæ ¼å¼çš„ç”Ÿæˆè„šæœ¬ï¼š

```bash
bash scripts/vbench/run_generation_vbench_format.sh --config configs/vbench_40_10_10files.yaml
```

æˆ–è€…ç›´æ¥ä½¿ç”¨Pythonè„šæœ¬ï¼š

```bash
python3 tools/vbench/run_generation_vbench_format.py --config configs/vbench_40_10_10files.yaml
```

### æ­¥éª¤ 3: éªŒè¯ç”Ÿæˆç»“æœ

ç”Ÿæˆå®Œæˆåï¼Œæ£€æŸ¥è§†é¢‘æ–‡ä»¶ï¼š

```bash
# æŸ¥çœ‹ç”Ÿæˆçš„è§†é¢‘æ•°é‡
ls -1 results/vbench/compare_40_10_10files/videos/*.mp4 | wc -l

# åº”è¯¥æ˜¾ç¤º 150 ä¸ªè§†é¢‘

# æŸ¥çœ‹ç¤ºä¾‹è§†é¢‘å‘½å
ls -1 results/vbench/compare_40_10_10files/videos/ | head -10
```

## ğŸ“ æ–‡ä»¶ç»“æ„

ç”Ÿæˆåçš„ç›®å½•ç»“æ„ï¼š

```
results/vbench/compare_40_10_10files/
â”œâ”€â”€ videos/                          # æ‰€æœ‰è§†é¢‘ä¿å­˜åœ¨è¿™é‡Œï¼ˆVBenchæ ¼å¼ï¼‰
â”‚   â”œâ”€â”€ a person swimming in ocean-0.mp4
â”‚   â”œâ”€â”€ a person swimming in ocean-1.mp4
â”‚   â”œâ”€â”€ a person swimming in ocean-2.mp4
â”‚   â”œâ”€â”€ a person swimming in ocean-3.mp4
â”‚   â”œâ”€â”€ a person swimming in ocean-4.mp4
â”‚   â”œâ”€â”€ alley-0.mp4
â”‚   â”œâ”€â”€ alley-1.mp4
â”‚   â”œâ”€â”€ ...
â”‚   â””â”€â”€ (æ€»å…±150ä¸ªè§†é¢‘)
â”œâ”€â”€ frames/                          # å¸§æ–‡ä»¶ï¼ˆå¦‚æœå¯ç”¨ï¼‰
â”œâ”€â”€ metrics/                         # è¯„ä¼°æŒ‡æ ‡
â”‚   â””â”€â”€ latency.json
â”œâ”€â”€ logs/                            # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ generation_progress.log
â””â”€â”€ metadata.csv                     # å…ƒæ•°æ®æ–‡ä»¶
```

## âœ… è§†é¢‘å‘½åæ ¼å¼éªŒè¯

ç”Ÿæˆçš„è§†é¢‘å‘½åæ ¼å¼å¿…é¡»ç¬¦åˆVBenchè¦æ±‚ï¼š

- âœ… æ ¼å¼: `{prompt}-{index}.mp4`
- âœ… promptæ–‡æœ¬å¿…é¡»ä¸ `VBench_full_info.json` ä¸­çš„ `prompt_en` å®Œå…¨ä¸€è‡´
- âœ… index ä» 0 å¼€å§‹: 0, 1, 2, 3, 4ï¼ˆæ¯ä¸ªprompt 5ä¸ªè§†é¢‘ï¼‰

### ç¤ºä¾‹å‘½å

```
a person swimming in ocean-0.mp4
a person swimming in ocean-1.mp4
a person swimming in ocean-2.mp4
a person swimming in ocean-3.mp4
a person swimming in ocean-4.mp4
alley-0.mp4
alley-1.mp4
alley-2.mp4
alley-3.mp4
alley-4.mp4
Close up of grapes on a rotating table.-0.mp4
Close up of grapes on a rotating table.-1.mp4
...
```

## ğŸ”§ é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶: `configs/vbench_40_10_10files.yaml`

å…³é”®é…ç½®é¡¹ï¼š
- `steps: "40,10"` - å‰40æ­¥5Bæ¨¡å‹ï¼Œå10æ­¥2Bæ¨¡å‹
- `seed_list: [1234, 2345, 3456, 4567, 5678]` - 5ä¸ªä¸åŒçš„éšæœºç§å­
- `prompt_file: prompts/vbench_10files_top3.txt` - åŒ…å«30ä¸ªpromptsçš„æ–‡ä»¶

## ğŸ“ æµ‹è¯•è¿è¡Œ

åœ¨æ­£å¼ç”Ÿæˆå‰ï¼Œå¯ä»¥å…ˆè¿›è¡Œæµ‹è¯•è¿è¡Œï¼ˆåªç”Ÿæˆå°‘é‡è§†é¢‘ï¼‰ï¼š

```bash
# åªç”Ÿæˆå‰2ä¸ªpromptsçš„è§†é¢‘ï¼ˆ10ä¸ªè§†é¢‘ï¼‰
bash scripts/vbench/run_generation_vbench_format.sh --config configs/vbench_40_10_10files.yaml --limit 10

# æˆ–è€…ä½¿ç”¨dry-runæ¨¡å¼ï¼ˆä¸å®é™…ç”Ÿæˆï¼Œåªæ£€æŸ¥ï¼‰
bash scripts/vbench/run_generation_vbench_format.sh --config configs/vbench_40_10_10files.yaml --dry-run
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Promptæ–‡æœ¬å¿…é¡»å®Œå…¨åŒ¹é…**: è§†é¢‘æ–‡ä»¶åä¸­çš„promptæ–‡æœ¬å¿…é¡»ä¸ `VBench_full_info.json` ä¸­çš„ `prompt_en` å®Œå…¨ä¸€è‡´ï¼ŒåŒ…æ‹¬ï¼š
   - å¤§å°å†™
   - æ ‡ç‚¹ç¬¦å·
   - ç©ºæ ¼

2. **æ–‡ä»¶ç³»ç»Ÿå…¼å®¹æ€§**: æŸäº›ç‰¹æ®Šå­—ç¬¦å¯èƒ½åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ä¸åˆæ³•ï¼Œå¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´ `sanitize_filename` å‡½æ•°ã€‚

3. **ç”Ÿæˆæ—¶é—´**: 150ä¸ªè§†é¢‘çš„ç”Ÿæˆå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå»ºè®®ï¼š
   - ä½¿ç”¨GPUåŠ é€Ÿ
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´
   - ç›‘æ§æ—¥å¿—æ–‡ä»¶äº†è§£è¿›åº¦

4. **æ–­ç‚¹ç»­ä¼ **: å¦‚æœç”Ÿæˆä¸­æ–­ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨è·³è¿‡å·²å­˜åœ¨çš„è§†é¢‘æ–‡ä»¶ï¼Œå¯ä»¥é‡æ–°è¿è¡Œç»§ç»­ç”Ÿæˆã€‚

## ğŸ“Š è¿›åº¦ç›‘æ§

ç”Ÿæˆè¿‡ç¨‹ä¸­å¯ä»¥æŸ¥çœ‹æ—¥å¿—ï¼š

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f results/vbench/compare_40_10_10files/logs/generation_progress.log

# æŸ¥çœ‹å·²ç”Ÿæˆçš„è§†é¢‘æ•°é‡
ls -1 results/vbench/compare_40_10_10files/videos/*.mp4 2>/dev/null | wc -l
```

## ğŸ¯ ä¸‹ä¸€æ­¥

ç”Ÿæˆå®Œæˆåï¼Œå¯ä»¥ï¼š

1. **è¿è¡ŒVBenchè¯„ä¼°**:
   ```bash
   bash scripts/vbench/run_eval.sh --config configs/vbench_40_10_10files.yaml
   ```

2. **æŸ¥çœ‹ç”Ÿæˆç»Ÿè®¡**:
   ```bash
   cat results/vbench/compare_40_10_10files/metrics/latency.json
   ```

3. **éªŒè¯è§†é¢‘æ ¼å¼**:
   ç¡®ä¿æ‰€æœ‰è§†é¢‘éƒ½ç¬¦åˆVBenchå‘½åè¦æ±‚ï¼Œå¯ä»¥ç›´æ¥ç”¨äºVBenchè¯„ä¼°ã€‚

---

**æœ€åæ›´æ–°**: 2025-11-15

